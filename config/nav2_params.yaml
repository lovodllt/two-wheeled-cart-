robot1:
  nav2_controller:
    ros__parameters:
      controller_plugin: "nav2_regulated_pure_pursuit_controller/RegulatedPurePursuitController"
      use_sim_time: True
      desired_linear_velocity: 0.3
      max_linear_velocity: 0.3
      min_linear_velocity: 0.05
      desired_angular_velocity: 0.5
      max_angular_velocity: 0.5
      min_angular_velocity: -0.5
      linear_acceleration_limits: 0.2
      angular_acceleration_limits: 0.5
      lookahead_distance: 0.5
      lookahead_time: 1.5
      min_lookahead_distance: 0.3
      max_lookahead_distance: 0.8

  nav2_planner:
    ros__parameters:
      planner_plugin: "nav2_behavior_tree::BehaviorTreePlanner"
      use_sim_time: True
      bt_xml_filename: "nav2_bt_navigator/bt_xmls/wait_at_waypoint_and_replan.xml"

  # 删除以下 nav2_recoveries 配置段
  # nav2_recoveries:
  #   ros__parameters:
  #     costmap_topic: "local_costmap/costmap_raw"
  #     footprint_topic: "local_costmap/published_footprint"
  #     cycle_frequency: 10.0
  #     recovery_plugins: ["spin", "backup", "wait"]
  #     spin:
  #       plugin: "nav2_recoveries/Spin"
  #     backup:
  #       plugin: "nav2_recoveries/Backup"
  #     wait:
  #       plugin: "nav2_recoveries/Wait"
  #     global_frame: "map"
  #     robot_base_frame: "base_link"
  #     use_sim_time: True

  nav2_bt_navigator:
    ros__parameters:
      use_sim_time: True
      # 修改 BT 文件：使用无恢复行为的版本（避免引用 recoveries）
      default_bt_xml_filename: "nav2_bt_navigator/bt_xmls/navigate_to_pose.xml"
      bt_loop_duration: 0.1
      nav2_api_timeout: 10.0

  nav2_amcl:
    ros__parameters:
      use_sim_time: True
      alpha1: 0.2
      alpha2: 0.2
      alpha3: 0.2
      alpha4: 0.2
      alpha5: 0.2
      base_frame_id: "base_link"
      global_frame_id: "map"
      odom_frame_id: "odom"  # 与 URDF 中的里程计帧一致
      lambda_short: 0.1
      laser_model_type: "likelihood_field"
      max_beams: 60
      max_particles: 2000
      min_particles: 500
      odom_alpha5: 0.1
      odom_frame_id: "odom"
      recovery_alpha_fast: 0.0
      recovery_alpha_slow: 0.0
      resample_interval: 1
      robot_model_type: "differential"  # 适配差速小车
      save_pose_rate: 0.5
      sigma_hit: 0.2
      tf_broadcast: True
      transform_tolerance: 0.1
      update_min_a: 0.2
      update_min_d: 0.25
      z_hit: 0.5
      z_max: 0.05
      z_rand: 0.5
      z_short: 0.05
